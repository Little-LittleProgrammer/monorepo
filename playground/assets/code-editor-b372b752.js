var M=Object.defineProperty;var z=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var k=(u,n,s)=>n in u?M(u,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[n]=s,B=(u,n)=>{for(var s in n||(n={}))L.call(n,s)&&k(u,s,n[s]);if(z)for(var s of z(n))T.call(n,s)&&k(u,s,n[s]);return u};var x=(u,n,s)=>new Promise((p,e)=>{var d=c=>{try{i(s.next(c))}catch(r){e(r)}},a=c=>{try{i(s.throw(c))}catch(r){e(r)}},i=c=>c.done?p(c.value):Promise.resolve(c.value).then(d,a);i((s=s.apply(u,n)).next())});import{d as S,A as W,B as v,D,F as O,o as g,g as m,v as j,n as h,G as C,H as q,I as N,J as P}from"./index-7f3c9944.js";const $={class:"q-code-editor"},A=h("path",{d:"M344 64H120c-30.9 0-56 25.1-56 56v224c0 30.9 25.1 56 56 56s56-25.1 56-56V175.9l168 0.1c30.9 0 56-25.1 56-56s-25.1-56-56-56zM344 848l-168 0.1V680c0-30.9-25.1-56-56-56s-56 25.1-56 56v224c0 30.9 25.1 56 56 56h224c30.9 0 56-25.1 56-56s-25.1-56-56-56zM904 624c-30.9 0-56 25.1-56 56l0.1 168H680c-30.9 0-56 25.1-56 56s25.1 56 56 56h224c30.9 0 56-25.1 56-56V680c0-30.9-25.1-56-56-56zM904 64H680c-30.9 0-56 25.1-56 56s25.1 56 56 56h168.1l-0.1 168c0 30.9 25.1 56 56 56s56-25.1 56-56V120c0-30.9-25.1-56-56-56z",fill:"#8a8a8a","p-id":"2320"},null,-1),I=[A],J=h("path",{d:"M358.4 921.6h-76.8v-179.2H102.4v-76.8h256v256z m307.2 0h76.8v-179.2h179.2v-76.8H665.6v256z m25.6-844.8h76.8v179.2h179.2v76.8H691.2V76.8zM332.8 76.8h-76.8v179.2H76.8v76.8h256V76.8z","p-id":"4737",fill:"#8a8a8a"},null,-1),K=[J],G=S({name:"code-editor",__name:"code-editor",props:{value:{default:""},language:{default:"typescript"},autoSave:{type:Boolean,default:!0},options:{},parse:{}},emits:["initd","save","change","blur"],setup(u,{expose:n,emit:s}){let p=null;W(()=>import("./editor.main-e1e6b02c.js"),["assets/editor.main-e1e6b02c.js","assets/index-7f3c9944.js","assets/index-4f0a6604.css"]).then(l=>{p=l,w.value=!0,H()}).catch(()=>{});const e=u,d=s;let a=null;const i=v(),c=v(!1),r=v(""),w=v(!1),y=new globalThis.ResizeObserver(()=>{setTimeout(()=>{a==null||a.layout()},300)});function V(){c.value=!c.value,setTimeout(()=>{a==null||a.layout,a==null||a.focus(),a==null||a.layout()},200)}const f=()=>b((a==null?void 0:a.getValue())||"");D(()=>e.value,(l,t)=>{l&&l!==t&&_(e.value)},{deep:!0,immediate:!0});function H(){return x(this,null,function*(){if(!i.value)return;const l=B({value:r.value,language:e.language,theme:"vs-dark"},e.options);try{a=p.editor.create(i.value,l),_(e.value||""),w.value=!1,i.value.addEventListener("keydown",t=>{if(t.keyCode===83&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)){t.preventDefault(),t.stopPropagation();const o=f();r.value=o,d("save",e.parse?e.parse(o,e.language):o),d("change",e.parse?e.parse(o,e.language):o),d("blur",e.parse?e.parse(o,e.language):o)}}),e.autoSave&&a.onDidBlurEditorWidget(()=>{const t=f();r.value!==t&&(r.value=t,d("save",e.parse?e.parse(t,e.language):t),d("blur",e.parse?e.parse(t,e.language):t),d("change",e.parse?e.parse(t,e.language):t))}),y.observe(i.value)}catch(t){}})}function b(l,t=e.language.toLocaleLowerCase()){let o="";return typeof l!="string"?t==="json"?o=JSON.stringify(l,null,4):o=P(l).replace(/"(\w+)":\s/g,"$1: "):o=l,["javascript","typescript"].includes(t)&&o.startsWith("{")&&o.endsWith("}")&&(o=`(${o})`),o}function _(l){const t=e.language.toLocaleLowerCase();return r.value=b(l,t),["javascript","typescript"].includes(t)&&!(l.startsWith("{")&&l.endsWith("}"))&&(r.value=r.value.replace(/;/g,`
`)),a==null?void 0:a.setValue(r.value)}return O(()=>{y.disconnect()}),n({values:r,getEditor(){return a},set_editor_value:_,get_editor_value:f,focus(){a==null||a.focus()}}),(l,t)=>(g(),m("div",$,[(g(),j(N,{to:"body",disabled:!c.value},[h("div",{class:q(["q-code-editor-wrapper",`${c.value?"full-screen":""}`])},[c.value?C("",!0):(g(),m("svg",{key:0,t:"1701256882326",class:"code-edit-full-screen-button",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2319",width:"200",height:"200",onClick:V},I)),c.value?(g(),m("svg",{key:1,t:"1701256780086",class:"code-edit-full-screen-button",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4736",width:"200",height:"200",onClick:V},K)):C("",!0),h("div",{ref_key:"codeEditor",ref:i,class:"q-code-editor-content"},null,512)],2)],8,["disabled"]))]))}});export{G as default};
